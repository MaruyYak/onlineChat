{"version":3,"file":"index.js","mappings":"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","sources":["webpack://fun-chat/./src/components/app-server/application-events-server.ts","webpack://fun-chat/./src/components/auth-page/auth-page-controller.ts","webpack://fun-chat/./src/components/auth-page/auth-page-view.ts","webpack://fun-chat/./src/components/main-page/chat-page-controller.ts","webpack://fun-chat/./src/components/main-page/chat-page-view.ts","webpack://fun-chat/./src/components/users/users-controller.ts","webpack://fun-chat/./src/services/chat-control-service.ts","webpack://fun-chat/./src/services/element-generator.ts","webpack://fun-chat/./src/services/login-service.ts","webpack://fun-chat/./src/services/logout-service.ts","webpack://fun-chat/./src/services/session-storage.ts","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/index.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/md5.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/native.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/nil.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/parse.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/regex.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/rng.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/sha1.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/stringify.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/v1.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/v3.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/v35.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/v4.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/v5.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/validate.js","webpack://fun-chat/./node_modules/uuid/dist/commonjs-browser/version.js","webpack://fun-chat/webpack/bootstrap","webpack://fun-chat/webpack/runtime/make namespace object","webpack://fun-chat/./src/index.ts"],"sourcesContent":["import { v4 as uuid } from \"uuid\";\r\nimport { StoreService } from \"../../services/session-storage\";\r\nimport { AuthController } from \"../auth-page/auth-page-controller\";\r\nimport { ChatController } from \"../main-page/chat-page-controller\";\r\nimport { UserListController } from \"../users/users-controller\";\r\nimport { Message } from \"../../types/types\";\r\nimport { ChatControlService } from \"../../services/chat-control-service\";\r\n\r\nexport class ApplicationEvents {\r\n  static ws: WebSocket;\r\n  static authController: AuthController;\r\n  static chatController: ChatController;\r\n  static userListController: UserListController;\r\n  \r\n  public static connect()  {\r\n    if(!ApplicationEvents.ws) {  \r\n      ApplicationEvents.ws = new WebSocket(\"ws://127.0.0.1:4000\");\r\n      this.ws.onmessage = this.onMessage;\r\n    }\r\n  }\r\n\r\n  public static setAppConrtollers( authController: AuthController, chatController: ChatController, userListController:UserListController) {\r\n    this.authController = authController;\r\n    this.chatController = chatController;\r\n    this.userListController = userListController;\r\n  }\r\n\r\n  public static onMessage(this: WebSocket, ev: MessageEvent<any>) {\r\n    const message = JSON.parse(ev.data)\r\n    console.log(\"message\", message);\r\n    \r\n    const messageType = message.type;\r\n    switch (messageType) {\r\n      case \"USER_LOGIN\":\r\n        const savePas = StoreService.getUserData()\r\n        const userLogin = message.payload.user;\r\n        userLogin.password = savePas?.password;\r\n        StoreService.setUserData(userLogin);\r\n        ApplicationEvents.chatController.drawChatPage()\r\n        ApplicationEvents.userListController.setStatus(userLogin)\r\n        break;\r\n\r\n      case \"ERROR\":\r\n        console.log('message from ERROR',message.payload.error)\r\n        ApplicationEvents.authController.loginError(message.payload.error)\r\n        break;\r\n\r\n      case \"USER_LOGOUT\":\r\n        StoreService.removeUserData();\r\n        ApplicationEvents.authController.drawAuthPage()\r\n        break;\r\n\r\n      case \"USER_ACTIVE\":\r\n        const usersActive = message.payload.users;\r\n        ApplicationEvents.userListController.addUserList(usersActive)\r\n        break;\r\n      \r\n      case \"USER_INACTIVE\":\r\n        const usersInactive = message.payload.users;\r\n        ApplicationEvents.userListController.addUserList(usersInactive)\r\n\r\n        break;\r\n        \r\n      case \"USER_EXTERNAL_LOGIN\":      \r\n        ApplicationEvents.userListController.setStatus(message.payload.user)\r\n        break;\r\n      \r\n      case \"USER_EXTERNAL_LOGOUT\":\r\n        ApplicationEvents.userListController.setStatus(message.payload.user)\r\n        break;\r\n\r\n      case \"MSG_SEND\":\r\n        const sendMessage = message.payload.message as Message\r\n        if(sendMessage.from === ChatControlService.selectedUser.login || \r\n          sendMessage.to === ChatControlService.selectedUser.login) {\r\n          ApplicationEvents.chatController.showMessage(message.payload.message)\r\n        }\r\n        break;\r\n\r\n      case \"MSG_FROM_USER\":\r\n        ApplicationEvents.chatController.showMessagesHistory(message.payload.messages)\r\n        break;\r\n        \r\n      case \"MSG_READ\":\r\n        ApplicationEvents.chatController.setReadStatus(message.payload.message)\r\n       \r\n      break;\r\n      \r\n      case \"MSG_EDIT\":\r\n        console.log('message from MSG_EDIT', message.payload.message)\r\n        ApplicationEvents.chatController.editMessage(message.payload.message)\r\n      break;\r\n\r\n      case \"MSG_DELETE\":\r\n        console.log('message from MSG_DELETE', message.payload.message)\r\n        ApplicationEvents.chatController.deleteMessage(message.payload.message)\r\n      break;\r\n\r\n      default:\r\n        console.log(message.payload)\r\n    }\r\n  }\r\n\r\n  public static send(type: string, payload: {[key:string]: any} | null) {\r\n    const request = {\r\n        id: `${uuid()}`,\r\n        type,\r\n        payload\r\n    };\r\n    console.log('type', type)\r\n    ApplicationEvents.ws.send(JSON.stringify(request));\r\n  }\r\n}","import { createElement } from \"../../services/element-generator\";\r\nimport { LoginService } from \"../../services/login-service\";\r\nimport { AuthPageView } from \"./auth-page-view\";\r\n\r\nexport class AuthController {\r\n  viewAuth!: AuthPageView;\r\n\r\n  constructor(loginService: LoginService) {\r\n    console.log(\"loginService1\", loginService)\r\n    this.viewAuth = new AuthPageView(this, loginService);\r\n  }\r\n  \r\n  public drawAuthPage() {\r\n    document.body.innerHTML = \"\";\r\n    this.viewAuth.createAuthPage();\r\n    this.viewAuth.createAuthForm();\r\n  }\r\n\r\n  public inputsValidation(input: HTMLInputElement, errorElement: HTMLElement): void {\r\n    const joinBtn = document.getElementById(\"join-btn\") as HTMLInputElement;\r\n\r\n    joinBtn.disabled = true;\r\n    let hasError = false;\r\n\r\n    const validUserCharacters = /^[a-zA-Zа-яА-Я0-9_-]{3,20}$/;\r\n\r\n    const validPasswordCharacters = /^.{4,}$/;\r\n\r\n    if (input.id === \"username\") {\r\n        if (!validUserCharacters.test(input.value)) {\r\n            hasError = true;\r\n            errorElement.innerText = \"Username must be 3-20 characters long and can contain letters, numbers, underscores, and dashes.\";\r\n            return;\r\n        }\r\n    }\r\n\r\n    if (input.id === \"password\") {\r\n      if (!validPasswordCharacters.test(input.value)) {\r\n          hasError = true;\r\n          errorElement.innerText = \"Password must be at least 4 characters long.\";\r\n          return;\r\n      }\r\n  }\r\n    errorElement.innerText = \"\";\r\n    joinBtn.disabled = hasError;\r\n  }\r\n\r\n    public loginError(error: string) {\r\n\r\n      const modalError = createElement({\r\n        tag: \"div\",\r\n        classes: [\"modal-error\"],\r\n        parent: document.body\r\n      })\r\n\r\n      modalError.style.display = \"flex\"\r\n  \r\n     const errorContainer = createElement({\r\n        tag: \"div\",\r\n        classes: [\"error-container\"],\r\n        parent: modalError\r\n      })\r\n  \r\n     createElement({\r\n        tag: \"p\",\r\n        text: `${error}`,\r\n        parent: errorContainer\r\n      })\r\n  \r\n     const closeBtn = createElement({\r\n        tag: \"button\",\r\n        text: \"OK\",\r\n        parent: errorContainer\r\n      })\r\n\r\n      document.addEventListener('keydown', (event) => {\r\n        if (event.key === \"Escape\" || event.key === \"Enter\") {\r\n          event.preventDefault();\r\n          modalError.style.display = \"none\"\r\n        }\r\n      });\r\n\r\n      closeBtn.addEventListener(\"click\", () => {\r\n        modalError.style.display = \"none\"\r\n      })\r\n    }\r\n\r\n  }\r\n\r\n\r\n","import { createElement } from \"../../services/element-generator\";\r\nimport { AuthController } from \"./auth-page-controller\";\r\nimport { LoginService } from \"../../services/login-service\";\r\nimport { StoreService } from \"../../services/session-storage\";\r\n\r\nexport class AuthPageView {\r\n  authMainContainer!: HTMLElement;\r\n  signupForm!: HTMLElement;\r\n\r\n  constructor(\r\n    private authController: AuthController, \r\n    private loginService: LoginService\r\n  ) {}\r\n\r\n  public createAuthPage(): void {\r\n    this.authMainContainer = createElement({\r\n      tag: \"main\",\r\n      classes: [\"main-auth\"],\r\n      parent: document.body,\r\n    });\r\n  }\r\n  \r\n  public createAuthForm(): void {\r\n    const signupSection = createElement({\r\n      tag: \"div\",\r\n      classes: [\"signup-section\"],\r\n      parent: this.authMainContainer,\r\n    })\r\n\r\n    const infoContent = createElement({\r\n      tag: \"div\",\r\n      classes: ['info-content'],\r\n      parent: signupSection,\r\n    })\r\n\r\n    const infoButton = createElement({\r\n      tag: \"div\",\r\n      classes: ['info-button'],\r\n      parent: signupSection,\r\n    })\r\n\r\n    const seeInfobtn = createElement({\r\n      tag: \"p\",\r\n      text: 'SEE INFO',\r\n      classes: ['button-text'],\r\n      parent: infoButton,\r\n    })\r\n\r\n    infoButton.addEventListener(\"click\", () => {\r\n      infoContent.classList.toggle('open')\r\n      if(infoContent.classList.contains('open')) {\r\n        setTimeout(() => {\r\n          seeInfobtn.innerText = 'CLOSE INFO'\r\n        }, 1000)\r\n      } else {\r\n        setTimeout(() => {\r\n          seeInfobtn.innerText = 'SEE INFO'\r\n        }, 1000)\r\n      }\r\n    });\r\n\r\n    createElement({\r\n      tag: \"h2\",\r\n      text: 'FAN CHAT is a lite version of the messenger for simple and active communication. After registration, you will have access to a list of all users who were also logged in earlier. You can select any user from the list and start a dialogue with them. It was designed in order to train working with websocket as part of the RSschool JS/FE 2023Q3 course',\r\n      parent: infoContent,\r\n    })\r\n\r\n    createElement({\r\n      tag: \"a\",\r\n      text: \"By MARYAK\",\r\n      parent: infoContent,\r\n      attributes: {\r\n        href: \"https://github.com/MaruyYak\",\r\n      },\r\n    });\r\n\r\n    this.signupForm = createElement({\r\n      tag: \"form\",\r\n      classes: [\"signupForm\"],\r\n      parent: signupSection,\r\n      attributes: {\r\n        id: 'signupform',\r\n      },\r\n    });\r\n\r\n    createElement({\r\n      tag: \"h2\",\r\n      text: \"Sign Up\",\r\n      parent: this.signupForm,\r\n    });\r\n\r\n    const formList = createElement({\r\n      tag: \"ul\",\r\n      classes: [\"no-bullet\"],\r\n      parent: this.signupForm,\r\n    });\r\n\r\n\r\n  [\"username\", \"password\"].forEach((placeholder) => {\r\n    const listItem = createElement({\r\n      tag: \"li\",\r\n      classes: ['li_input'],\r\n      parent: formList,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"label\",\r\n      parent: listItem,\r\n      attributes: {\r\n        for: placeholder,\r\n      },\r\n    });\r\n\r\n    const input = createElement({\r\n      tag: \"input\",\r\n      classes: [\"inputFields\"],\r\n      parent: listItem,\r\n      attributes: {\r\n        type: placeholder === \"password\" ? \"password\" : \"text\",\r\n        id: placeholder,\r\n        name: placeholder,\r\n        placeholder: placeholder,\r\n        required: `${true}`\r\n      },\r\n    }) as HTMLInputElement;\r\n\r\n    const errorId = `error_${placeholder}`;\r\n    createElement({\r\n        tag: \"span\",\r\n        id: errorId,\r\n        classes: [\"error-mes\"],\r\n        parent: listItem,\r\n    });\r\n\r\n    const errorElement = document.getElementById(errorId) as HTMLSpanElement;\r\n    \r\n    input.addEventListener(\"input\", () => {\r\n      this.authController.inputsValidation(input, errorElement);\r\n      });\r\n    });\r\n\r\n    // const radioButtons = createElement({\r\n    //   tag: \"div\",\r\n    //   classes: [\"radio-buttons\"],\r\n    //   parent: formList\r\n    // });\r\n\r\n    // const maleLabel = createElement({\r\n    //   tag: \"label\",\r\n    //   text: \"Male\",\r\n    //   attributes: {\r\n    //     for: \"male\"\r\n    //   },\r\n    //   parent: radioButtons\r\n    // });\r\n    // const maleButton = createElement({\r\n    //   tag: \"input\",\r\n    //   attributes: {\r\n    //     type: \"radio\",\r\n    //     id: \"male\",\r\n    //     value:\"male\",\r\n    //   },\r\n    //   parent: radioButtons\r\n    // }) as HTMLInputElement;\r\n\r\n    // const femaleLabel = createElement({\r\n    //   tag: \"label\",\r\n    //   text: \"Female\",\r\n    //   attributes: {\r\n    //     for: \"female\"\r\n    //   },\r\n    //   parent: radioButtons\r\n    // });\r\n    // const felameButton = createElement({\r\n    //   tag: \"input\",\r\n    //   attributes: {\r\n    //     type: \"radio\",\r\n    //     id: \"female\",\r\n    //     value:\"female\",\r\n    //   },\r\n    //   parent: radioButtons\r\n    // }) as HTMLInputElement;\r\n    \r\n    // maleButton.addEventListener(\"click\", () => {\r\n    //   if (maleButton.checked) {\r\n    //     felameButton.checked = false\r\n    //   }\r\n    // })\r\n    \r\n    // felameButton.addEventListener(\"click\", () => {\r\n    //   if (felameButton.checked) {\r\n    //     maleButton.checked = false\r\n    //   }\r\n    // })\r\n\r\n    const joinBtnListItem = createElement({\r\n      tag: \"li\",\r\n      parent: formList,\r\n      id: \"center-btn\",\r\n    });\r\n\r\n    const joinBtn = createElement({\r\n      tag: \"input\",\r\n      attributes: {\r\n        type: \"submit\",\r\n        id: \"join-btn\",\r\n        name: \"join\",\r\n        alt: \"Join\"\r\n     },\r\n      parent: joinBtnListItem,\r\n    }) as HTMLInputElement;\r\n    \r\n    this.signupForm.addEventListener(\"submit\", (event) => {\r\n      let username =  (document.getElementById(\"username\") as HTMLInputElement).value;\r\n      let password = (document.getElementById(\"password\") as HTMLInputElement).value;\r\n\r\n      event.preventDefault()\r\n      this.loginService.letUserLogin(username, password)\r\n    });\r\n\r\n    joinBtn.disabled = true;\r\n  }\r\n\r\n}","import { ChatControlService } from \"../../services/chat-control-service\";\r\nimport { createElement } from \"../../services/element-generator\";\r\nimport { Message } from \"../../types/types\";\r\nimport { ChatPageView } from \"./chat-page-view\";\r\n\r\nexport class ChatController {\r\n  viewChatPage: ChatPageView;\r\n  chatControlService: ChatControlService;\r\n  messagesArr: {message: Message, htmlEl: HTMLElement}[] = [];\r\n  isMyScroll = false;\r\n  editedMessage: Message | null = null;\r\n\r\n  constructor() {\r\n    this.viewChatPage = new ChatPageView(this);\r\n    this.chatControlService = new ChatControlService();\r\n  }\r\n  \r\n\r\n  public drawChatPage() {\r\n    document.body.innerHTML = \"\";\r\n    this.viewChatPage.createMainPage();\r\n    this.viewChatPage.createChatContainer();\r\n    this.viewChatPage.createChatMenu();\r\n    this.viewChatPage.createUsersArea();\r\n    this.viewChatPage.createChatInfo();\r\n    this.viewChatPage.createChat();\r\n    this.chatControlService.getUsersList();\r\n\r\n    this.setEventListenersToMessage();\r\n    this.setEventListenersToSentButton();\r\n  }\r\n\r\n  public clearChatWindow() {\r\n    const messageInput = document.getElementById('textPlace') as HTMLInputElement;\r\n    const dialogContent = document.querySelector('.dialog-content') as HTMLElement;\r\n    const sendButton = document.getElementById('sendBtn') as HTMLInputElement;\r\n    const saveButton = document.getElementById('saveBtn') as HTMLInputElement;\r\n    \r\n    dialogContent.innerHTML = \"\"\r\n\r\n    if(saveButton.style.display === \"flex\") {\r\n      saveButton.style.display = \"none\"\r\n      sendButton.style.display = \"flex\"\r\n    }\r\n  \r\n    messageInput.disabled = false;\r\n    sendButton.disabled = false;\r\n   }\r\n  \r\n  public showMessage(messageContent: Message): HTMLElement {\r\n    const dialogContent = document.querySelector('.dialog-content') as HTMLElement\r\n    const className = messageContent.to === ChatControlService.selectedUser.login ?\r\n    'to' : 'from';\r\n    \r\n    const date = new Date(messageContent.datetime);\r\n    const month = (date.getMonth() + 1).toString().padStart(2, '0');\r\n    const day = date.getDate().toString().padStart(2, '0');\r\n    const hours = date.getHours().toString().padStart(2, '0');\r\n    const minutes = date.getMinutes().toString().padStart(2, '0');\r\n    \r\n    const dateTimeString = `${month}-${day}  ${hours}:${minutes}`;\r\n    const messageHtml = this.viewChatPage.createNewMessage(messageContent, className, dateTimeString);\r\n    this.messagesArr.push({message: messageContent, htmlEl: messageHtml})\r\n    const unreadMark = messageHtml.querySelector(\".unread-mark\") as HTMLElement;\r\n    const readMark =  messageHtml.querySelector(\".read-mark\") as HTMLElement;\r\n    const editdMark =  messageHtml.querySelector(\".edited\") as HTMLElement;\r\n\r\n    if(messageContent.status.isReaded && messageContent.to === ChatControlService.selectedUser.login) {\r\n      unreadMark.style.display = 'none';\r\n      readMark.style.display = 'flex';\r\n    }\r\n    if(messageContent.status.isEdited) {\r\n      editdMark.style.display = 'flex';      \r\n    }\r\n\r\n    this.isMyScroll = true;\r\n    dialogContent.scrollTop = dialogContent.scrollHeight;\r\n      setTimeout(() => {\r\n        this.isMyScroll = false;\r\n      }, 500)\r\n\r\n    return messageHtml;\r\n  }\r\n  \r\n  public showMessagesHistory(messages: Message[]) {\r\n    this.messagesArr = messages.map((message) => ({\r\n      message,\r\n      htmlEl: this.showMessage(message)\r\n    }))\r\n  }\r\n\r\n\r\n  public setReadStatus(message: Message) {\r\n    const readMessage = this.messagesArr.find(mes => mes.message.id === message.id)\r\n    if(readMessage) {\r\n      readMessage.message.status.isReaded = true;\r\n      this.messagesArr.push({message: readMessage.message, htmlEl: readMessage.htmlEl})\r\n    }\r\n\r\n    if(readMessage?.message.to !== ChatControlService.selectedUser.login) {\r\n      return\r\n    }\r\n\r\n    const unreadMark = readMessage?.htmlEl.querySelector(\".unread-mark\") as HTMLElement;\r\n    const readMark =  readMessage?.htmlEl.querySelector(\".read-mark\") as HTMLElement;\r\n\r\n    unreadMark.style.display = 'none';\r\n    readMark.style.display = 'flex';\r\n  }\r\n  \r\n  public requestEditMessage(message: Message) {\r\n    this.editedMessage = message;\r\n\r\n    const messageInput = document.getElementById('textPlace') as HTMLInputElement;\r\n    const saveButton = document.getElementById('saveBtn') as HTMLButtonElement;\r\n    const sendButton = document.getElementById('sendBtn') as HTMLButtonElement;\r\n\r\n    messageInput.value = message.text; \r\n    saveButton.style.display = \"flex\"\r\n    sendButton.style.display = \"none\"\r\n  }\r\n\r\n  public editMessage(message: Message) {   \r\n    const saveButton = document.getElementById('saveBtn') as HTMLInputElement;\r\n    const textInput = document.getElementById('textPlace') as HTMLInputElement;\r\n    const sendButton = document.getElementById('sendBtn') as HTMLInputElement;\r\n    textInput.value = \"\"\r\n    saveButton.style.display = \"none\"\r\n    sendButton.style.display = \"flex\"\r\n\r\n    const editedMessage = this.messagesArr.find(mes => mes.message.id === message.id);\r\n    if(editedMessage) {\r\n      editedMessage.message.status.isEdited = true;\r\n      this.messagesArr.push({message: editedMessage.message, htmlEl: editedMessage.htmlEl})\r\n    }\r\n    const changeText = editedMessage?.htmlEl.querySelector(\".text\") as HTMLElement;\r\n    const edited = editedMessage?.htmlEl.querySelector('.edited') as HTMLInputElement;\r\n   if(changeText) {   \r\n      edited.style.display = \"flex\"\r\n     changeText.innerText = message.text\r\n   }      \r\n  }\r\n  \r\n  public deleteMessage(message: Message) {\r\n    const findMessage = this.messagesArr.filter(mes => mes.message.id !== message.id);\r\n    this.clearChatWindow();\r\n    this.showMessagesHistory(findMessage.map(mes => mes.message));\r\n  }\r\n\r\n  public setEventListenersToMessage() {\r\n    const dialogContent = document.querySelector(\".dialog-content\") as HTMLElement;\r\n    const sendButton = document.querySelector(\".send-button\") as HTMLElement;\r\n    \r\n    dialogContent.addEventListener('scroll', () => {\r\n      if(!this.isMyScroll) {\r\n        this.readMessages();\r\n      }\r\n    });\r\n    \r\n    dialogContent.addEventListener('click', () => {\r\n        this.readMessages();\r\n    });\r\n\r\n    sendButton.addEventListener('click', () => {\r\n        this.readMessages();\r\n    });\r\n   \r\n    sendButton.addEventListener('keydown', (event) => {\r\n          event.preventDefault();\r\n        if (event.key === \"Enter\") {\r\n          this.readMessages();          \r\n        }\r\n      });\r\n  }\r\n\r\n  public readMessages() {\r\n    this.messagesArr.forEach(item => {\r\n      if(!item.message.status.isReaded && ChatControlService.selectedUser.login === item.message.from) {\r\n        ChatControlService.requestReadStatus(item.message.id)\r\n      }\r\n    })\r\n  }\r\n\r\n  public setEventListenersToSentButton() {\r\n    const messageInput = document.getElementById('textPlace') as HTMLInputElement;\r\n    const sendButton = document.getElementById('sendBtn') as HTMLInputElement;\r\n    const mesMenu = document.getElementById('mes-menu') as HTMLInputElement;\r\n    const saveButton = document.getElementById('saveBtn') as HTMLButtonElement;\r\n    \r\n    saveButton.addEventListener(\"click\", () => {\r\n      ChatControlService.requestTextEditing(this.editedMessage?.id || '0' , messageInput.value)\r\n      this.editedMessage = null;\r\n    })\r\n\r\n    document.addEventListener('keydown', (event) => {\r\n      if (event.key === \"Escape\" && this.editedMessage) {\r\n        this.editedMessage = null;\r\n        sendButton.style.display = \"flex\";\r\n        saveButton.style.display = \"none\";\r\n        messageInput.value = \"\";\r\n        mesMenu.style.visibility = 'hidden';\r\n      }\r\n    });\r\n\r\n    sendButton.addEventListener('click', () => {\r\n      if (messageInput.value != '') {\r\n        ChatControlService.sendMessageToUser(messageInput.value)\r\n        messageInput.value = \"\"\r\n      }\r\n    });\r\n\r\n    messageInput.addEventListener('keydown', (event: KeyboardEvent) => {\r\n      if (event.key !== \"Enter\") {\r\n        return;\r\n      }\r\n      event.preventDefault();\r\n      if (messageInput.value === '') {\r\n        return;\r\n      }\r\n      if(this.editedMessage) {\r\n        ChatControlService.requestTextEditing(this.editedMessage.id, messageInput.value);\r\n        this.editedMessage = null;\r\n      } else {\r\n        ChatControlService.sendMessageToUser(messageInput.value);\r\n      }\r\n\r\n      messageInput.value = \"\";\r\n    });\r\n  }\r\n}","import { createElement } from \"../../services/element-generator\";\r\nimport { LogOutServis } from \"../../services/logout-service\";\r\nimport { StoreService } from \"../../services/session-storage\";\r\nimport { ChatControlService } from \"../../services/chat-control-service\";\r\nimport { Message } from \"../../types/types\";\r\nimport { ChatController } from \"./chat-page-controller\";\r\n\r\nexport class ChatPageView {\r\n  chatContainer!: HTMLElement\r\n  chatWrapper!: HTMLElement\r\n  main!: HTMLElement\r\n  infoButton!: HTMLElement\r\n  infoMenu!: HTMLElement\r\n  menuUsers!: HTMLElement\r\n  userArea!: HTMLElement\r\n  dialogContent!: HTMLElement\r\n  letUserLogOut: LogOutServis;\r\n  chatControlService: ChatControlService;\r\n  isEditMode = false\r\n\r\n  constructor(public chatController: ChatController) {\r\n    this.letUserLogOut = new LogOutServis();\r\n    this.chatControlService = new ChatControlService();\r\n  }\r\n\r\n  public createMainPage(): void {\r\n    this.main = createElement({\r\n      tag: \"main\",\r\n      classes: [\"main-chat-page\"],\r\n      parent: document.body,\r\n    });\r\n\r\n    const footerInfo = createElement({\r\n      tag: \"footer\",\r\n      classes: [\"footer-info\"],\r\n      parent: this.main,\r\n  });\r\n\r\n    const logoImg = createElement({\r\n        tag: \"img\",\r\n        attributes: { src: \"./assets/rs_school.svg\", alt: \"RSSchool\" },\r\n        parent: footerInfo,\r\n    });\r\n\r\n    const githubLink = createElement({\r\n        tag: \"a\",\r\n        attributes: { href: \"https://github.com/MaruyYak\" },\r\n        text: \"MaruyYak\",\r\n        parent: footerInfo,\r\n    });\r\n\r\n    const yearSpan = createElement({\r\n        tag: \"span\",\r\n        text: \"2023\",\r\n        parent: footerInfo,\r\n    });\r\n  }\r\n\r\n  public createChatContainer(): void {\r\n    this.chatContainer = createElement({\r\n      tag: \"div\",\r\n      classes: [\"chat-container\"],\r\n      parent: this.main,\r\n    });\r\n\r\n    const chatHeader = createElement({\r\n      tag: \"div\",\r\n      classes: [\"chat-header\"],\r\n      parent: this.chatContainer,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"h1\",\r\n      text: \"FUN CHAT\",\r\n      parent: chatHeader,\r\n    });\r\n\r\n    const usersData = createElement({\r\n      tag: \"div\",\r\n      classes: [\"user-data\"],\r\n      parent: chatHeader,\r\n    });\r\n    \r\n    const saveUsersLogin =  StoreService.getUserData()\r\n\r\n    createElement({\r\n      tag: \"p\",\r\n      classes: [\"my-login\"],\r\n      text: `${saveUsersLogin?.login}`,\r\n      parent: usersData,\r\n    });\r\n\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      classes: [\"avatar\"],\r\n      src: \"./assets/user-avatar.gif\",\r\n      parent: usersData,\r\n    });\r\n\r\n    this.chatWrapper = createElement({\r\n      tag: \"div\",\r\n      classes: [\"chat-wrapper\"],\r\n      parent: this.chatContainer,\r\n    });\r\n  }\r\n\r\n  public createChatMenu(): void {\r\n    const chatMenu = createElement({\r\n      tag: \"div\",\r\n      classes: [\"chat-menu\"],\r\n      parent: this.chatWrapper,\r\n    });\r\n\r\n    const menuButtons = createElement({\r\n      tag: \"div\",\r\n      classes: [\"menu-buttons\"],\r\n      parent: chatMenu,\r\n    });\r\n\r\n    const exitButton = createElement({\r\n      tag: \"div\",\r\n      classes: [\"exit-btn\"],\r\n      parent: menuButtons,\r\n    });\r\n\r\n    exitButton.addEventListener('click', () => {\r\n      const loginedUser = StoreService.getUserData();\r\n      this.letUserLogOut.letUserLogOut(loginedUser)\r\n    })\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      src: './assets/log-out.png',\r\n      parent: exitButton,\r\n    });\r\n\r\n    this.infoButton = createElement({\r\n      tag: \"div\",\r\n      classes: [\"info-btn\"],\r\n      parent: menuButtons,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      src: './assets/info-icon.png',\r\n      parent: this.infoButton,\r\n    });\r\n    \r\n    this.infoButton.addEventListener(\"click\", () => {\r\n        this.userArea.classList.add('user-area_closed')\r\n        this.infoButton.classList.add('selected')\r\n\r\n        this.infoMenu.classList.remove('chat-info_closed')\r\n        this.menuUsers.classList.remove('selected')\r\n    });\r\n\r\n    this.menuUsers = createElement({\r\n      tag: \"div\",\r\n      classes: [\"info-users\", \"selected\"],\r\n      parent: menuButtons,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      src: './assets/users-list.png',\r\n      parent: this.menuUsers,\r\n    });\r\n\r\n    this.menuUsers.addEventListener(\"click\", () => {\r\n        this.userArea.classList.remove('user-area_closed')\r\n        this.menuUsers.classList.add('selected')\r\n\r\n        this.infoMenu.classList.add('chat-info_closed')\r\n        this.infoButton.classList.remove('selected')\r\n    });\r\n  }\r\n\r\n  public createUsersArea(): void {\r\n    this.userArea = createElement({\r\n      tag: \"div\",\r\n      classes: [\"user-area\"],\r\n      parent: this.chatWrapper,\r\n    });\r\n\r\n    const search = createElement({\r\n      tag: \"input\",\r\n      attributes: {\r\n        id: \"search\",\r\n        type: \"text\",\r\n        placeholder: \"Search\",\r\n      },\r\n      parent: this.userArea,\r\n    });\r\n    \r\n    createElement({\r\n      tag: \"ul\",\r\n      classes: [\"user-list\"],\r\n      parent:this.userArea,\r\n    });\r\n\r\n  }\r\n\r\n  public createChatInfo(): void {\r\n    this.infoMenu = createElement({\r\n        tag: \"div\",\r\n        classes: [\"chat-info\", \"chat-info_closed\"],\r\n        parent: this.chatWrapper,\r\n    });\r\n\r\n    const infoTitle = createElement({\r\n        tag: \"h3\",\r\n        classes: [\"info-title\"],\r\n        text: \"FUN CHAT\",\r\n        parent: this.infoMenu,\r\n    });\r\n\r\n    const logoImg = createElement({\r\n        tag: \"img\",\r\n        attributes: { src: \"./assets/logo.png\", alt: \"logo\" },\r\n        parent: this.infoMenu,\r\n    });\r\n\r\n    const infoText = createElement({\r\n        tag: \"p\",\r\n        text: \"You have access to a list of all users who were also logged in earlier. You can select any user from the list and start a dialogue with them. \"\r\n         + \"It was designed in order to train working with websocket as part of the RSschool JS/FE 2023Q3 course\",\r\n        parent: this.infoMenu,\r\n    });\r\n\r\n    const authorLink = createElement({\r\n        tag: \"a\",\r\n        attributes: { href: \"https://github.com/MaruyYak\" },\r\n        text: \"By MARYYAK\",\r\n        parent: this.infoMenu,\r\n    });\r\n\r\n  }\r\n  \r\n  public createChat(): void {\r\n    const chatContent = createElement({\r\n        tag: \"div\",\r\n        classes: [\"chat-content\"],\r\n        parent: this.chatWrapper,\r\n    });\r\n\r\n    const chatArea = createElement({\r\n        tag: \"div\",\r\n        classes: [\"chat-area\"],\r\n        parent: chatContent,\r\n    });\r\n\r\n    const friendInfo = createElement({\r\n        tag: \"div\",\r\n        classes: [\"open-user-info\"],\r\n        parent: chatArea,\r\n    });\r\n\r\n    const friendName = createElement({\r\n        tag: \"label\",\r\n        classes: [\"open-user\"],\r\n        text: \"Chat with:\",\r\n        parent: friendInfo,\r\n    });\r\n\r\n    const friendStatus = createElement({\r\n        tag: \"span\",\r\n        id: \"openUserStatus\",\r\n        parent: friendInfo,\r\n    });\r\n\r\n    this.dialogContent = createElement({\r\n        tag: \"div\",\r\n        classes: [\"dialog-content\"],\r\n        parent: chatArea,\r\n    });\r\n\r\n    createElement({\r\n        tag: \"span\",\r\n        text: \"Select the user to send the message to...\",\r\n        classes: [\"dialog-empty\"],\r\n        parent: this.dialogContent,\r\n    });\r\n\r\n    const messageArea = createElement({\r\n        tag: \"div\",\r\n        classes: [\"message-area\"],\r\n        parent: chatArea,\r\n    });\r\n\r\n    const messageInput = createElement({\r\n        tag: \"input\",\r\n        id: \"textPlace\",\r\n        attributes: { \r\n          type: \"text\", \r\n          placeholder: \"Message...\",\r\n          required: `${true}`\r\n        },\r\n        parent: messageArea,\r\n    }) as HTMLInputElement;\r\n\r\n    messageInput.disabled = true\r\n\r\n\r\n    const saveButton = createElement({\r\n        tag: \"button\",\r\n        id: \"saveBtn\",\r\n        classes: [\"send-button\"],\r\n        text: \"Save\",\r\n        parent: messageArea,\r\n    }) as HTMLButtonElement;\r\n\r\n    saveButton.style.display = \"none\"\r\n\r\n    const sendButton = createElement({\r\n        tag: \"button\",\r\n        id: \"sendBtn\",\r\n        classes: [\"send-button\"],\r\n        text: \"Send\",\r\n        parent: messageArea,\r\n    }) as HTMLButtonElement;\r\n\r\n      sendButton.disabled = true\r\n  }\r\n\r\n  public createNewMessage(messageDetails: Message, className: string, dateTime: string): HTMLElement {\r\n    const messageContainer = createElement({\r\n      tag: \"div\",\r\n      classes: [\"message-container\", className],\r\n      parent: this.dialogContent,\r\n    });\r\n\r\n    const messageContent = createElement({\r\n        tag: \"div\",\r\n        classes: [\"message-content\"],\r\n        parent: messageContainer,\r\n    });\r\n\r\n    const mesMenu = createElement({\r\n      tag: \"div\",\r\n      id: 'mes-menu',\r\n      parent: messageContent,\r\n    });\r\n    mesMenu.style.visibility = 'hidden'\r\n\r\n    createElement({\r\n      tag: \"span\",\r\n      text: \"Edit\",\r\n      id: 'edit',\r\n      parent: mesMenu,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"span\",\r\n      text: \"Delete\",\r\n      id: 'delete',\r\n      parent: mesMenu,\r\n    });\r\n\r\n    // createElement({\r\n    //   tag: \"img\",\r\n    //   src: \"./assets/edit.png\",\r\n    //   id: 'edit',\r\n    //   parent: mesMenu,\r\n    // });\r\n\r\n    // createElement({\r\n    //   tag: \"img\",\r\n    //   src: \"./assets/delete.png\",\r\n    //   id: 'delete',\r\n    //   parent: mesMenu,\r\n    // });\r\n\r\n    createElement({\r\n        tag: \"p\",\r\n        text: `${messageDetails.from }`,\r\n        classes: [\"mes_from\"],\r\n        parent: messageContent,\r\n    });\r\n\r\n    const messageText = createElement({\r\n        tag: \"p\",\r\n        classes: [\"text\"],\r\n        text: `${messageDetails.text}`,\r\n        parent: messageContent,\r\n    });\r\n\r\n    let isContextMenuOpen = false; \r\n\r\n    if(className === \"to\") {      \r\n      messageText.addEventListener('contextmenu', (event) => {\r\n        event.preventDefault();\r\n        if (!isContextMenuOpen) {\r\n            mesMenu.style.visibility = 'visible';\r\n            isContextMenuOpen = true;\r\n        } else {\r\n            mesMenu.style.visibility = 'hidden';\r\n            isContextMenuOpen = false;\r\n        }\r\n       });\r\n\r\n        document.addEventListener('click', (event) => {\r\n          if (!mesMenu.contains(event.target as Node)) {\r\n            mesMenu.style.visibility = 'hidden';\r\n            isContextMenuOpen = false;\r\n          }\r\n        });\r\n        \r\n        mesMenu.addEventListener('click', (event) => {\r\n          const clickedMenu = event.target as HTMLElement;\r\n          if(clickedMenu.id === \"edit\"){\r\n            this.chatController.requestEditMessage(messageDetails);\r\n            mesMenu.style.visibility = 'hidden';\r\n            isContextMenuOpen = false;\r\n          }\r\n          if(clickedMenu.id === \"delete\") {\r\n            ChatControlService.requestTextDeleting(messageDetails);\r\n            mesMenu.style.visibility = 'hidden';\r\n            isContextMenuOpen = false;\r\n          }\r\n      })\r\n    }\r\n\r\n\r\n    const messageInfo = createElement({\r\n        tag: \"div\",\r\n        classes: [\"message-info\"],\r\n        parent: messageContent,\r\n    });\r\n\r\n    createElement({\r\n        tag: \"label\",\r\n        id: \"dateTime\",\r\n        text: `${dateTime}`,\r\n        parent: messageInfo,\r\n    });\r\n\r\n    const unreadMark = createElement({\r\n        tag: \"div\",\r\n        classes: [\"unread-mark\"],\r\n        parent: messageInfo,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      classes: [\"unread\"],\r\n      src: './assets/mark-unread.png',\r\n      parent: unreadMark,\r\n    });\r\n\r\n    className === \"to\" ? unreadMark.style.display = \"flex\" : \"none\"\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      classes: [\"unread\"],\r\n      src: './assets/mark-unread.png',\r\n      parent: unreadMark,\r\n    });\r\n    \r\n    const readMark = createElement({\r\n      tag: \"div\",\r\n      classes: [\"read-mark\"],\r\n      parent: messageInfo,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      classes: [\"readed\"],\r\n      src: './assets/mark-readed.png',\r\n      parent: readMark,\r\n    });\r\n\r\n    createElement({\r\n      tag: \"img\",\r\n      classes: [\"readed\"],\r\n      src: './assets/mark-readed.png',\r\n      parent: readMark,\r\n    });\r\n\r\n    const edit = createElement({\r\n      tag: \"img\",\r\n      classes: [\"edited\"],\r\n      src: './assets/edited.png',\r\n      parent: messageInfo,\r\n    }) as HTMLElement;\r\n\r\n    edit.style.display = \"none\";\r\n\r\n    return messageContainer;\r\n  }\r\n}\r\n","import { createElement } from \"../../services/element-generator\";\r\nimport { ChatControlService } from \"../../services/chat-control-service\";\r\nimport { User } from \"../../types/types\";\r\nimport { ChatController } from \"../main-page/chat-page-controller\";\r\n\r\n\r\nexport class UserListController {\r\n  chatController: ChatController;\r\n  userList: User[] = [];\r\n  userListArr: {user: User, htmlEl: HTMLElement}[] = [];\r\n\r\n  constructor() {\r\n    this.chatController = new ChatController();\r\n  }\r\n\r\n  public addUserList(users: User[]) {\r\n    this.userList = [...this.userList, ...users]\r\n    this.drawUserItems();\r\n    this.setEventListenertoUser();\r\n    this.searchUsers();\r\n  }\r\n\r\n  public drawUserItems() {\r\n    const domUsersList = document.querySelector('.user-list') as HTMLUListElement\r\n    const myLogin = document.querySelector('.my-login')?.textContent\r\n    domUsersList.innerHTML = \"\"\r\n\r\n    this.userList.filter((notme) => notme.login !== myLogin)\r\n    .forEach(user => {\r\n      const userItem = createElement({\r\n        tag: \"li\",\r\n        classes: ['user'],\r\n        text: user.login,\r\n        parent: domUsersList\r\n      });\r\n      const classStus = user.isLogined ? [\"online\"] : [\"offline\"]\r\n      createElement({\r\n        tag: \"span\",\r\n        classes: [\"status\", `${classStus}`],\r\n        parent: userItem\r\n      });\r\n      this.userListArr.push({user: user, htmlEl: userItem})\r\n    });\r\n\r\n  }\r\n\r\n  public setStatus(user: User) {\r\n    const externalUser = this.userList.find(item => item.login === user.login);\r\n    if(externalUser){\r\n      externalUser.isLogined = user.isLogined;\r\n    } else {\r\n      this.userList.push(user)\r\n    }\r\n    this.drawUserItems()\r\n  }\r\n\r\n  private setEventListenertoUser() {\r\n    const usersList = document.querySelector(\".user-list\") as HTMLLIElement\r\n    const textPlace = document.getElementById(\"textPlace\") as HTMLInputElement\r\n\r\n    usersList.addEventListener('click', (event) => {\r\n      if(textPlace.value != \"\") {\r\n        textPlace.value = \"\"\r\n      }\r\n      const clickedListItem = event.target as HTMLLIElement;\r\n      const openUserhtml = document.querySelector('.open-user') as HTMLInputElement\r\n      const openUserStatus = document.getElementById('openUserStatus') as HTMLInputElement\r\n\r\n      if(!clickedListItem.classList.contains(\"user\")) {\r\n        return;\r\n      }\r\n    \r\n      const openUserLogin = clickedListItem.textContent;\r\n      openUserhtml.innerText = `Chat with: ${openUserLogin}`;\r\n      const finededUser = this.userList.find(user => user.login === openUserLogin);\r\n      \r\n      if(!finededUser || openUserLogin === ChatControlService.selectedUser?.login) {\r\n        return;\r\n      }\r\n\r\n      this.chatController.clearChatWindow()\r\n      ChatControlService.selectUser(finededUser);    \r\n      ChatControlService.getMessageHistory(finededUser.login)\r\n      \r\n      if(finededUser && finededUser.isLogined) {\r\n        openUserStatus.classList.add(\"online\")\r\n        openUserStatus.classList.remove(\"offline\")\r\n      } else {\r\n        openUserStatus.classList.remove(\"online\")\r\n        openUserStatus.classList.add(\"offline\")\r\n      }\r\n      \r\n    });\r\n  }\r\n\r\n  public searchUsers(): void {\r\n    const searchInput = document.getElementById('search') as HTMLInputElement;\r\n    searchInput.addEventListener('input', () => {\r\n      const searchText = searchInput.value.toLowerCase();\r\n      this.userListArr.forEach(user => {\r\n          const userStatus = document.querySelector('.status') as HTMLLIElement;\r\n            const userName = user.user.login.toLowerCase();\r\n            if (userName?.includes(searchText)) {\r\n                user.htmlEl.style.display = 'flex'; \r\n                userStatus.style.display = 'flex'\r\n            } else {\r\n                user.htmlEl.style.display = 'none';\r\n                userStatus.style.display = 'none'\r\n            }\r\n        });\r\n    });\r\n  }\r\n}\r\n","import { ApplicationEvents } from \"../components/app-server/application-events-server\";\r\nimport { Message, User } from \"../types/types\";\r\n\r\nexport class ChatControlService {\r\n  \r\n  static selectedUser: User;\r\n\r\n  static selectUser(user: User) {\r\n    this.selectedUser = user\r\n  }\r\n\r\n  public getUsersList(): void {\r\n    [\"USER_ACTIVE\",\"USER_INACTIVE\"].forEach(type => {\r\n      const payload = null\r\n      ApplicationEvents.send(type, payload);\r\n    })\r\n  }\r\n  \r\n  static sendMessageToUser(message: string): void {\r\n    const type = \"MSG_SEND\";\r\n    const payload = {\r\n            message: {\r\n              to: ChatControlService.selectedUser.login,\r\n              text: message,\r\n            }\r\n          };\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n\r\n  static getMessageHistory(login: string) {\r\n    const type = \"MSG_FROM_USER\";\r\n    const payload = {\r\n            user: {\r\n              login: login,\r\n            }\r\n          };\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n\r\n  static requestReadStatus(messageId: string) {\r\n    const type = \"MSG_READ\";\r\n    const payload = {\r\n        message: {\r\n              id: messageId,\r\n            }\r\n          };\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n\r\n  static requestTextEditing(id:string , text: string) {\r\n    const type = \"MSG_EDIT\";\r\n    const payload = {\r\n        message: {\r\n            id: id,\r\n            text: text\r\n            }\r\n          };\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n\r\n  static requestTextDeleting(message: Message) {\r\n    const type = \"MSG_DELETE\";\r\n    const payload = {\r\n        message: {\r\n            id: message.id,\r\n            }\r\n          };\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n}","import { HtmlElementOptions } from \"../types/types\";\r\n\r\nexport function createElement(options: HtmlElementOptions): HTMLElement {\r\n  const {\r\n    tag = \"div\",\r\n    text = \"\",\r\n    parent,\r\n    classes = [],\r\n    src = \"\",\r\n    style = {},\r\n    id = \"\",\r\n    type = \"\",\r\n    attributes = {}\r\n  } = options;\r\n\r\n  const element = document.createElement(tag);\r\n\r\n  element.textContent = String(text);\r\n\r\n  Object.assign(element.style, style);\r\n\r\n  if (tag === \"img\") {\r\n    (element as HTMLImageElement).src = src as string;\r\n  }\r\n\r\n  if( id !== \"\") {\r\n    element.id = id;\r\n  }\r\n\r\n  if (tag === \"input\") {\r\n    (element as HTMLInputElement).type = type;\r\n  }\r\n\r\n  if (classes.length > 0) {\r\n    element.classList.add(...classes);\r\n  }\r\n\r\n  if (parent != null) {\r\n    parent.appendChild(element);\r\n  }\r\n\r\n  for (const [key, value] of Object.entries(attributes)) {\r\n    element.setAttribute(key, value as string);\r\n  }\r\n\r\n  return element;\r\n}\r\n","import { ApplicationEvents } from \"../components/app-server/application-events-server\";\r\nimport { StoreService } from \"./session-storage\";\r\nimport { ChatControlService } from \"./chat-control-service\";\r\n\r\nexport class LoginService {\r\n  \r\n  public letUserLogin(login: string, password: string): void {\r\n    const type = \"USER_LOGIN\";\r\n    const payload = {\r\n            user: {\r\n              login: login,\r\n              password: password\r\n            }\r\n          };\r\n\r\n    const passwordObj = {\r\n            login: \"\",\r\n            password: password,\r\n            isLogined: false,\r\n          }\r\n    \r\n    StoreService.setUserData(passwordObj);\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n}\r\n","import { ApplicationEvents } from \"../components/app-server/application-events-server\";\r\nimport { LoginedUser } from \"../types/types\";\r\n\r\nexport class LogOutServis {\r\n\r\n  public letUserLogOut(loginedUser:LoginedUser | null): void {\r\n    const type = \"USER_LOGOUT\";\r\n    const payload = {\r\n            user: {\r\n              login: loginedUser?.login,\r\n              password: loginedUser?.password\r\n            }\r\n          };\r\n    ApplicationEvents.send(type, payload);\r\n  }\r\n}\r\n","import { LoginedUser } from \"../types/types\";\r\n\r\nexport class StoreService {\r\n  public static getUserData(): LoginedUser | null {\r\n    const storedData = sessionStorage.getItem(\"LoginedUser\");\r\n    if (storedData) {\r\n      return JSON.parse(storedData);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  public static getUserGender(): string | null {\r\n    const storedData = sessionStorage.getItem(\"UserGender\");\r\n    if (storedData) {\r\n      return JSON.parse(storedData);\r\n    }\r\n    return null;\r\n  }\r\n\r\n  public static setUserGender(userGender: string) {\r\n    sessionStorage.setItem(\"UserGender\", JSON.stringify(userGender));\r\n  }\r\n\r\n  public static setUserData(loginedUser: LoginedUser) {\r\n    sessionStorage.setItem(\"LoginedUser\", JSON.stringify(loginedUser));\r\n  }\r\n\r\n  public static removeUserData(): void {\r\n    sessionStorage.removeItem(\"LoginedUser\");\r\n    sessionStorage.removeItem(\"UserGender\");\r\n  }\r\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nObject.defineProperty(exports, \"NIL\", {\n  enumerable: true,\n  get: function get() {\n    return _nil.default;\n  }\n});\nObject.defineProperty(exports, \"parse\", {\n  enumerable: true,\n  get: function get() {\n    return _parse.default;\n  }\n});\nObject.defineProperty(exports, \"stringify\", {\n  enumerable: true,\n  get: function get() {\n    return _stringify.default;\n  }\n});\nObject.defineProperty(exports, \"v1\", {\n  enumerable: true,\n  get: function get() {\n    return _v.default;\n  }\n});\nObject.defineProperty(exports, \"v3\", {\n  enumerable: true,\n  get: function get() {\n    return _v2.default;\n  }\n});\nObject.defineProperty(exports, \"v4\", {\n  enumerable: true,\n  get: function get() {\n    return _v3.default;\n  }\n});\nObject.defineProperty(exports, \"v5\", {\n  enumerable: true,\n  get: function get() {\n    return _v4.default;\n  }\n});\nObject.defineProperty(exports, \"validate\", {\n  enumerable: true,\n  get: function get() {\n    return _validate.default;\n  }\n});\nObject.defineProperty(exports, \"version\", {\n  enumerable: true,\n  get: function get() {\n    return _version.default;\n  }\n});\n\nvar _v = _interopRequireDefault(require(\"./v1.js\"));\n\nvar _v2 = _interopRequireDefault(require(\"./v3.js\"));\n\nvar _v3 = _interopRequireDefault(require(\"./v4.js\"));\n\nvar _v4 = _interopRequireDefault(require(\"./v5.js\"));\n\nvar _nil = _interopRequireDefault(require(\"./nil.js\"));\n\nvar _version = _interopRequireDefault(require(\"./version.js\"));\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nvar _stringify = _interopRequireDefault(require(\"./stringify.js\"));\n\nvar _parse = _interopRequireDefault(require(\"./parse.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n/*\n * Browser-compatible JavaScript MD5\n *\n * Modification of JavaScript MD5\n * https://github.com/blueimp/JavaScript-MD5\n *\n * Copyright 2011, Sebastian Tschan\n * https://blueimp.net\n *\n * Licensed under the MIT license:\n * https://opensource.org/licenses/MIT\n *\n * Based on\n * A JavaScript implementation of the RSA Data Security, Inc. MD5 Message\n * Digest Algorithm, as defined in RFC 1321.\n * Version 2.2 Copyright (C) Paul Johnston 1999 - 2009\n * Other contributors: Greg Holt, Andrew Kepert, Ydnar, Lostinet\n * Distributed under the BSD License\n * See http://pajhome.org.uk/crypt/md5 for more info.\n */\nfunction md5(bytes) {\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = new Uint8Array(msg.length);\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes[i] = msg.charCodeAt(i);\n    }\n  }\n\n  return md5ToHexEncodedArray(wordsToMd5(bytesToWords(bytes), bytes.length * 8));\n}\n/*\n * Convert an array of little-endian words to an array of bytes\n */\n\n\nfunction md5ToHexEncodedArray(input) {\n  const output = [];\n  const length32 = input.length * 32;\n  const hexTab = '0123456789abcdef';\n\n  for (let i = 0; i < length32; i += 8) {\n    const x = input[i >> 5] >>> i % 32 & 0xff;\n    const hex = parseInt(hexTab.charAt(x >>> 4 & 0x0f) + hexTab.charAt(x & 0x0f), 16);\n    output.push(hex);\n  }\n\n  return output;\n}\n/**\n * Calculate output length with padding and bit length\n */\n\n\nfunction getOutputLength(inputLength8) {\n  return (inputLength8 + 64 >>> 9 << 4) + 14 + 1;\n}\n/*\n * Calculate the MD5 of an array of little-endian words, and a bit length.\n */\n\n\nfunction wordsToMd5(x, len) {\n  /* append padding */\n  x[len >> 5] |= 0x80 << len % 32;\n  x[getOutputLength(len) - 1] = len;\n  let a = 1732584193;\n  let b = -271733879;\n  let c = -1732584194;\n  let d = 271733878;\n\n  for (let i = 0; i < x.length; i += 16) {\n    const olda = a;\n    const oldb = b;\n    const oldc = c;\n    const oldd = d;\n    a = md5ff(a, b, c, d, x[i], 7, -680876936);\n    d = md5ff(d, a, b, c, x[i + 1], 12, -389564586);\n    c = md5ff(c, d, a, b, x[i + 2], 17, 606105819);\n    b = md5ff(b, c, d, a, x[i + 3], 22, -1044525330);\n    a = md5ff(a, b, c, d, x[i + 4], 7, -176418897);\n    d = md5ff(d, a, b, c, x[i + 5], 12, 1200080426);\n    c = md5ff(c, d, a, b, x[i + 6], 17, -1473231341);\n    b = md5ff(b, c, d, a, x[i + 7], 22, -45705983);\n    a = md5ff(a, b, c, d, x[i + 8], 7, 1770035416);\n    d = md5ff(d, a, b, c, x[i + 9], 12, -1958414417);\n    c = md5ff(c, d, a, b, x[i + 10], 17, -42063);\n    b = md5ff(b, c, d, a, x[i + 11], 22, -1990404162);\n    a = md5ff(a, b, c, d, x[i + 12], 7, 1804603682);\n    d = md5ff(d, a, b, c, x[i + 13], 12, -40341101);\n    c = md5ff(c, d, a, b, x[i + 14], 17, -1502002290);\n    b = md5ff(b, c, d, a, x[i + 15], 22, 1236535329);\n    a = md5gg(a, b, c, d, x[i + 1], 5, -165796510);\n    d = md5gg(d, a, b, c, x[i + 6], 9, -1069501632);\n    c = md5gg(c, d, a, b, x[i + 11], 14, 643717713);\n    b = md5gg(b, c, d, a, x[i], 20, -373897302);\n    a = md5gg(a, b, c, d, x[i + 5], 5, -701558691);\n    d = md5gg(d, a, b, c, x[i + 10], 9, 38016083);\n    c = md5gg(c, d, a, b, x[i + 15], 14, -660478335);\n    b = md5gg(b, c, d, a, x[i + 4], 20, -405537848);\n    a = md5gg(a, b, c, d, x[i + 9], 5, 568446438);\n    d = md5gg(d, a, b, c, x[i + 14], 9, -1019803690);\n    c = md5gg(c, d, a, b, x[i + 3], 14, -187363961);\n    b = md5gg(b, c, d, a, x[i + 8], 20, 1163531501);\n    a = md5gg(a, b, c, d, x[i + 13], 5, -1444681467);\n    d = md5gg(d, a, b, c, x[i + 2], 9, -51403784);\n    c = md5gg(c, d, a, b, x[i + 7], 14, 1735328473);\n    b = md5gg(b, c, d, a, x[i + 12], 20, -1926607734);\n    a = md5hh(a, b, c, d, x[i + 5], 4, -378558);\n    d = md5hh(d, a, b, c, x[i + 8], 11, -2022574463);\n    c = md5hh(c, d, a, b, x[i + 11], 16, 1839030562);\n    b = md5hh(b, c, d, a, x[i + 14], 23, -35309556);\n    a = md5hh(a, b, c, d, x[i + 1], 4, -1530992060);\n    d = md5hh(d, a, b, c, x[i + 4], 11, 1272893353);\n    c = md5hh(c, d, a, b, x[i + 7], 16, -155497632);\n    b = md5hh(b, c, d, a, x[i + 10], 23, -1094730640);\n    a = md5hh(a, b, c, d, x[i + 13], 4, 681279174);\n    d = md5hh(d, a, b, c, x[i], 11, -358537222);\n    c = md5hh(c, d, a, b, x[i + 3], 16, -722521979);\n    b = md5hh(b, c, d, a, x[i + 6], 23, 76029189);\n    a = md5hh(a, b, c, d, x[i + 9], 4, -640364487);\n    d = md5hh(d, a, b, c, x[i + 12], 11, -421815835);\n    c = md5hh(c, d, a, b, x[i + 15], 16, 530742520);\n    b = md5hh(b, c, d, a, x[i + 2], 23, -995338651);\n    a = md5ii(a, b, c, d, x[i], 6, -198630844);\n    d = md5ii(d, a, b, c, x[i + 7], 10, 1126891415);\n    c = md5ii(c, d, a, b, x[i + 14], 15, -1416354905);\n    b = md5ii(b, c, d, a, x[i + 5], 21, -57434055);\n    a = md5ii(a, b, c, d, x[i + 12], 6, 1700485571);\n    d = md5ii(d, a, b, c, x[i + 3], 10, -1894986606);\n    c = md5ii(c, d, a, b, x[i + 10], 15, -1051523);\n    b = md5ii(b, c, d, a, x[i + 1], 21, -2054922799);\n    a = md5ii(a, b, c, d, x[i + 8], 6, 1873313359);\n    d = md5ii(d, a, b, c, x[i + 15], 10, -30611744);\n    c = md5ii(c, d, a, b, x[i + 6], 15, -1560198380);\n    b = md5ii(b, c, d, a, x[i + 13], 21, 1309151649);\n    a = md5ii(a, b, c, d, x[i + 4], 6, -145523070);\n    d = md5ii(d, a, b, c, x[i + 11], 10, -1120210379);\n    c = md5ii(c, d, a, b, x[i + 2], 15, 718787259);\n    b = md5ii(b, c, d, a, x[i + 9], 21, -343485551);\n    a = safeAdd(a, olda);\n    b = safeAdd(b, oldb);\n    c = safeAdd(c, oldc);\n    d = safeAdd(d, oldd);\n  }\n\n  return [a, b, c, d];\n}\n/*\n * Convert an array bytes to an array of little-endian words\n * Characters >255 have their high-byte silently ignored.\n */\n\n\nfunction bytesToWords(input) {\n  if (input.length === 0) {\n    return [];\n  }\n\n  const length8 = input.length * 8;\n  const output = new Uint32Array(getOutputLength(length8));\n\n  for (let i = 0; i < length8; i += 8) {\n    output[i >> 5] |= (input[i / 8] & 0xff) << i % 32;\n  }\n\n  return output;\n}\n/*\n * Add integers, wrapping at 2^32. This uses 16-bit operations internally\n * to work around bugs in some JS interpreters.\n */\n\n\nfunction safeAdd(x, y) {\n  const lsw = (x & 0xffff) + (y & 0xffff);\n  const msw = (x >> 16) + (y >> 16) + (lsw >> 16);\n  return msw << 16 | lsw & 0xffff;\n}\n/*\n * Bitwise rotate a 32-bit number to the left.\n */\n\n\nfunction bitRotateLeft(num, cnt) {\n  return num << cnt | num >>> 32 - cnt;\n}\n/*\n * These functions implement the four basic operations the algorithm uses.\n */\n\n\nfunction md5cmn(q, a, b, x, s, t) {\n  return safeAdd(bitRotateLeft(safeAdd(safeAdd(a, q), safeAdd(x, t)), s), b);\n}\n\nfunction md5ff(a, b, c, d, x, s, t) {\n  return md5cmn(b & c | ~b & d, a, b, x, s, t);\n}\n\nfunction md5gg(a, b, c, d, x, s, t) {\n  return md5cmn(b & d | c & ~d, a, b, x, s, t);\n}\n\nfunction md5hh(a, b, c, d, x, s, t) {\n  return md5cmn(b ^ c ^ d, a, b, x, s, t);\n}\n\nfunction md5ii(a, b, c, d, x, s, t) {\n  return md5cmn(c ^ (b | ~d), a, b, x, s, t);\n}\n\nvar _default = md5;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nconst randomUUID = typeof crypto !== 'undefined' && crypto.randomUUID && crypto.randomUUID.bind(crypto);\nvar _default = {\n  randomUUID\n};\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = '00000000-0000-0000-0000-000000000000';\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction parse(uuid) {\n  if (!(0, _validate.default)(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  let v;\n  const arr = new Uint8Array(16); // Parse ########-....-....-....-............\n\n  arr[0] = (v = parseInt(uuid.slice(0, 8), 16)) >>> 24;\n  arr[1] = v >>> 16 & 0xff;\n  arr[2] = v >>> 8 & 0xff;\n  arr[3] = v & 0xff; // Parse ........-####-....-....-............\n\n  arr[4] = (v = parseInt(uuid.slice(9, 13), 16)) >>> 8;\n  arr[5] = v & 0xff; // Parse ........-....-####-....-............\n\n  arr[6] = (v = parseInt(uuid.slice(14, 18), 16)) >>> 8;\n  arr[7] = v & 0xff; // Parse ........-....-....-####-............\n\n  arr[8] = (v = parseInt(uuid.slice(19, 23), 16)) >>> 8;\n  arr[9] = v & 0xff; // Parse ........-....-....-....-############\n  // (Use \"/\" to avoid 32-bit truncation when bit-shifting high-order bytes)\n\n  arr[10] = (v = parseInt(uuid.slice(24, 36), 16)) / 0x10000000000 & 0xff;\n  arr[11] = v / 0x100000000 & 0xff;\n  arr[12] = v >>> 24 & 0xff;\n  arr[13] = v >>> 16 & 0xff;\n  arr[14] = v >>> 8 & 0xff;\n  arr[15] = v & 0xff;\n  return arr;\n}\n\nvar _default = parse;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nvar _default = /^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = rng;\n// Unique ID creation requires a high quality random # generator. In the browser we therefore\n// require the crypto API and do not support built-in fallback to lower quality random number\n// generators (like Math.random()).\nlet getRandomValues;\nconst rnds8 = new Uint8Array(16);\n\nfunction rng() {\n  // lazy load so that environments that need to polyfill have a chance to do so\n  if (!getRandomValues) {\n    // getRandomValues needs to be invoked in a context where \"this\" is a Crypto implementation.\n    getRandomValues = typeof crypto !== 'undefined' && crypto.getRandomValues && crypto.getRandomValues.bind(crypto);\n\n    if (!getRandomValues) {\n      throw new Error('crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported');\n    }\n  }\n\n  return getRandomValues(rnds8);\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\n// Adapted from Chris Veness' SHA1 code at\n// http://www.movable-type.co.uk/scripts/sha1.html\nfunction f(s, x, y, z) {\n  switch (s) {\n    case 0:\n      return x & y ^ ~x & z;\n\n    case 1:\n      return x ^ y ^ z;\n\n    case 2:\n      return x & y ^ x & z ^ y & z;\n\n    case 3:\n      return x ^ y ^ z;\n  }\n}\n\nfunction ROTL(x, n) {\n  return x << n | x >>> 32 - n;\n}\n\nfunction sha1(bytes) {\n  const K = [0x5a827999, 0x6ed9eba1, 0x8f1bbcdc, 0xca62c1d6];\n  const H = [0x67452301, 0xefcdab89, 0x98badcfe, 0x10325476, 0xc3d2e1f0];\n\n  if (typeof bytes === 'string') {\n    const msg = unescape(encodeURIComponent(bytes)); // UTF8 escape\n\n    bytes = [];\n\n    for (let i = 0; i < msg.length; ++i) {\n      bytes.push(msg.charCodeAt(i));\n    }\n  } else if (!Array.isArray(bytes)) {\n    // Convert Array-like to Array\n    bytes = Array.prototype.slice.call(bytes);\n  }\n\n  bytes.push(0x80);\n  const l = bytes.length / 4 + 2;\n  const N = Math.ceil(l / 16);\n  const M = new Array(N);\n\n  for (let i = 0; i < N; ++i) {\n    const arr = new Uint32Array(16);\n\n    for (let j = 0; j < 16; ++j) {\n      arr[j] = bytes[i * 64 + j * 4] << 24 | bytes[i * 64 + j * 4 + 1] << 16 | bytes[i * 64 + j * 4 + 2] << 8 | bytes[i * 64 + j * 4 + 3];\n    }\n\n    M[i] = arr;\n  }\n\n  M[N - 1][14] = (bytes.length - 1) * 8 / Math.pow(2, 32);\n  M[N - 1][14] = Math.floor(M[N - 1][14]);\n  M[N - 1][15] = (bytes.length - 1) * 8 & 0xffffffff;\n\n  for (let i = 0; i < N; ++i) {\n    const W = new Uint32Array(80);\n\n    for (let t = 0; t < 16; ++t) {\n      W[t] = M[i][t];\n    }\n\n    for (let t = 16; t < 80; ++t) {\n      W[t] = ROTL(W[t - 3] ^ W[t - 8] ^ W[t - 14] ^ W[t - 16], 1);\n    }\n\n    let a = H[0];\n    let b = H[1];\n    let c = H[2];\n    let d = H[3];\n    let e = H[4];\n\n    for (let t = 0; t < 80; ++t) {\n      const s = Math.floor(t / 20);\n      const T = ROTL(a, 5) + f(s, b, c, d) + e + K[s] + W[t] >>> 0;\n      e = d;\n      d = c;\n      c = ROTL(b, 30) >>> 0;\n      b = a;\n      a = T;\n    }\n\n    H[0] = H[0] + a >>> 0;\n    H[1] = H[1] + b >>> 0;\n    H[2] = H[2] + c >>> 0;\n    H[3] = H[3] + d >>> 0;\n    H[4] = H[4] + e >>> 0;\n  }\n\n  return [H[0] >> 24 & 0xff, H[0] >> 16 & 0xff, H[0] >> 8 & 0xff, H[0] & 0xff, H[1] >> 24 & 0xff, H[1] >> 16 & 0xff, H[1] >> 8 & 0xff, H[1] & 0xff, H[2] >> 24 & 0xff, H[2] >> 16 & 0xff, H[2] >> 8 & 0xff, H[2] & 0xff, H[3] >> 24 & 0xff, H[3] >> 16 & 0xff, H[3] >> 8 & 0xff, H[3] & 0xff, H[4] >> 24 & 0xff, H[4] >> 16 & 0xff, H[4] >> 8 & 0xff, H[4] & 0xff];\n}\n\nvar _default = sha1;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\nexports.unsafeStringify = unsafeStringify;\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n/**\n * Convert array of 16 byte values to UUID string format of the form:\n * XXXXXXXX-XXXX-XXXX-XXXX-XXXXXXXXXXXX\n */\nconst byteToHex = [];\n\nfor (let i = 0; i < 256; ++i) {\n  byteToHex.push((i + 0x100).toString(16).slice(1));\n}\n\nfunction unsafeStringify(arr, offset = 0) {\n  // Note: Be careful editing this code!  It's been tuned for performance\n  // and works in ways you may not expect. See https://github.com/uuidjs/uuid/pull/434\n  return byteToHex[arr[offset + 0]] + byteToHex[arr[offset + 1]] + byteToHex[arr[offset + 2]] + byteToHex[arr[offset + 3]] + '-' + byteToHex[arr[offset + 4]] + byteToHex[arr[offset + 5]] + '-' + byteToHex[arr[offset + 6]] + byteToHex[arr[offset + 7]] + '-' + byteToHex[arr[offset + 8]] + byteToHex[arr[offset + 9]] + '-' + byteToHex[arr[offset + 10]] + byteToHex[arr[offset + 11]] + byteToHex[arr[offset + 12]] + byteToHex[arr[offset + 13]] + byteToHex[arr[offset + 14]] + byteToHex[arr[offset + 15]];\n}\n\nfunction stringify(arr, offset = 0) {\n  const uuid = unsafeStringify(arr, offset); // Consistency check for valid UUID.  If this throws, it's likely due to one\n  // of the following:\n  // - One or more input array values don't map to a hex octet (leading to\n  // \"undefined\" in the uuid)\n  // - Invalid input values for the RFC `version` or `variant` fields\n\n  if (!(0, _validate.default)(uuid)) {\n    throw TypeError('Stringified UUID is invalid');\n  }\n\n  return uuid;\n}\n\nvar _default = stringify;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _rng = _interopRequireDefault(require(\"./rng.js\"));\n\nvar _stringify = require(\"./stringify.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// **`v1()` - Generate time-based UUID**\n//\n// Inspired by https://github.com/LiosK/UUID.js\n// and http://docs.python.org/library/uuid.html\nlet _nodeId;\n\nlet _clockseq; // Previous uuid creation time\n\n\nlet _lastMSecs = 0;\nlet _lastNSecs = 0; // See https://github.com/uuidjs/uuid for API details\n\nfunction v1(options, buf, offset) {\n  let i = buf && offset || 0;\n  const b = buf || new Array(16);\n  options = options || {};\n  let node = options.node || _nodeId;\n  let clockseq = options.clockseq !== undefined ? options.clockseq : _clockseq; // node and clockseq need to be initialized to random values if they're not\n  // specified.  We do this lazily to minimize issues related to insufficient\n  // system entropy.  See #189\n\n  if (node == null || clockseq == null) {\n    const seedBytes = options.random || (options.rng || _rng.default)();\n\n    if (node == null) {\n      // Per 4.5, create and 48-bit node id, (47 random bits + multicast bit = 1)\n      node = _nodeId = [seedBytes[0] | 0x01, seedBytes[1], seedBytes[2], seedBytes[3], seedBytes[4], seedBytes[5]];\n    }\n\n    if (clockseq == null) {\n      // Per 4.2.2, randomize (14 bit) clockseq\n      clockseq = _clockseq = (seedBytes[6] << 8 | seedBytes[7]) & 0x3fff;\n    }\n  } // UUID timestamps are 100 nano-second units since the Gregorian epoch,\n  // (1582-10-15 00:00).  JSNumbers aren't precise enough for this, so\n  // time is handled internally as 'msecs' (integer milliseconds) and 'nsecs'\n  // (100-nanoseconds offset from msecs) since unix epoch, 1970-01-01 00:00.\n\n\n  let msecs = options.msecs !== undefined ? options.msecs : Date.now(); // Per 4.2.1.2, use count of uuid's generated during the current clock\n  // cycle to simulate higher resolution clock\n\n  let nsecs = options.nsecs !== undefined ? options.nsecs : _lastNSecs + 1; // Time since last uuid creation (in msecs)\n\n  const dt = msecs - _lastMSecs + (nsecs - _lastNSecs) / 10000; // Per 4.2.1.2, Bump clockseq on clock regression\n\n  if (dt < 0 && options.clockseq === undefined) {\n    clockseq = clockseq + 1 & 0x3fff;\n  } // Reset nsecs if clock regresses (new clockseq) or we've moved onto a new\n  // time interval\n\n\n  if ((dt < 0 || msecs > _lastMSecs) && options.nsecs === undefined) {\n    nsecs = 0;\n  } // Per 4.2.1.2 Throw error if too many uuids are requested\n\n\n  if (nsecs >= 10000) {\n    throw new Error(\"uuid.v1(): Can't create more than 10M uuids/sec\");\n  }\n\n  _lastMSecs = msecs;\n  _lastNSecs = nsecs;\n  _clockseq = clockseq; // Per 4.1.4 - Convert from unix epoch to Gregorian epoch\n\n  msecs += 12219292800000; // `time_low`\n\n  const tl = ((msecs & 0xfffffff) * 10000 + nsecs) % 0x100000000;\n  b[i++] = tl >>> 24 & 0xff;\n  b[i++] = tl >>> 16 & 0xff;\n  b[i++] = tl >>> 8 & 0xff;\n  b[i++] = tl & 0xff; // `time_mid`\n\n  const tmh = msecs / 0x100000000 * 10000 & 0xfffffff;\n  b[i++] = tmh >>> 8 & 0xff;\n  b[i++] = tmh & 0xff; // `time_high_and_version`\n\n  b[i++] = tmh >>> 24 & 0xf | 0x10; // include version\n\n  b[i++] = tmh >>> 16 & 0xff; // `clock_seq_hi_and_reserved` (Per 4.2.2 - include variant)\n\n  b[i++] = clockseq >>> 8 | 0x80; // `clock_seq_low`\n\n  b[i++] = clockseq & 0xff; // `node`\n\n  for (let n = 0; n < 6; ++n) {\n    b[i + n] = node[n];\n  }\n\n  return buf || (0, _stringify.unsafeStringify)(b);\n}\n\nvar _default = v1;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _v = _interopRequireDefault(require(\"./v35.js\"));\n\nvar _md = _interopRequireDefault(require(\"./md5.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst v3 = (0, _v.default)('v3', 0x30, _md.default);\nvar _default = v3;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.URL = exports.DNS = void 0;\nexports.default = v35;\n\nvar _stringify = require(\"./stringify.js\");\n\nvar _parse = _interopRequireDefault(require(\"./parse.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction stringToBytes(str) {\n  str = unescape(encodeURIComponent(str)); // UTF8 escape\n\n  const bytes = [];\n\n  for (let i = 0; i < str.length; ++i) {\n    bytes.push(str.charCodeAt(i));\n  }\n\n  return bytes;\n}\n\nconst DNS = '6ba7b810-9dad-11d1-80b4-00c04fd430c8';\nexports.DNS = DNS;\nconst URL = '6ba7b811-9dad-11d1-80b4-00c04fd430c8';\nexports.URL = URL;\n\nfunction v35(name, version, hashfunc) {\n  function generateUUID(value, namespace, buf, offset) {\n    var _namespace;\n\n    if (typeof value === 'string') {\n      value = stringToBytes(value);\n    }\n\n    if (typeof namespace === 'string') {\n      namespace = (0, _parse.default)(namespace);\n    }\n\n    if (((_namespace = namespace) === null || _namespace === void 0 ? void 0 : _namespace.length) !== 16) {\n      throw TypeError('Namespace must be array-like (16 iterable integer values, 0-255)');\n    } // Compute hash of namespace and value, Per 4.3\n    // Future: Use spread syntax when supported on all platforms, e.g. `bytes =\n    // hashfunc([...namespace, ... value])`\n\n\n    let bytes = new Uint8Array(16 + value.length);\n    bytes.set(namespace);\n    bytes.set(value, namespace.length);\n    bytes = hashfunc(bytes);\n    bytes[6] = bytes[6] & 0x0f | version;\n    bytes[8] = bytes[8] & 0x3f | 0x80;\n\n    if (buf) {\n      offset = offset || 0;\n\n      for (let i = 0; i < 16; ++i) {\n        buf[offset + i] = bytes[i];\n      }\n\n      return buf;\n    }\n\n    return (0, _stringify.unsafeStringify)(bytes);\n  } // Function#name is not settable on some platforms (#270)\n\n\n  try {\n    generateUUID.name = name; // eslint-disable-next-line no-empty\n  } catch (err) {} // For CommonJS default export support\n\n\n  generateUUID.DNS = DNS;\n  generateUUID.URL = URL;\n  return generateUUID;\n}","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _native = _interopRequireDefault(require(\"./native.js\"));\n\nvar _rng = _interopRequireDefault(require(\"./rng.js\"));\n\nvar _stringify = require(\"./stringify.js\");\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction v4(options, buf, offset) {\n  if (_native.default.randomUUID && !buf && !options) {\n    return _native.default.randomUUID();\n  }\n\n  options = options || {};\n\n  const rnds = options.random || (options.rng || _rng.default)(); // Per 4.4, set bits for version and `clock_seq_hi_and_reserved`\n\n\n  rnds[6] = rnds[6] & 0x0f | 0x40;\n  rnds[8] = rnds[8] & 0x3f | 0x80; // Copy bytes to buffer, if provided\n\n  if (buf) {\n    offset = offset || 0;\n\n    for (let i = 0; i < 16; ++i) {\n      buf[offset + i] = rnds[i];\n    }\n\n    return buf;\n  }\n\n  return (0, _stringify.unsafeStringify)(rnds);\n}\n\nvar _default = v4;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _v = _interopRequireDefault(require(\"./v35.js\"));\n\nvar _sha = _interopRequireDefault(require(\"./sha1.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nconst v5 = (0, _v.default)('v5', 0x50, _sha.default);\nvar _default = v5;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _regex = _interopRequireDefault(require(\"./regex.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction validate(uuid) {\n  return typeof uuid === 'string' && _regex.default.test(uuid);\n}\n\nvar _default = validate;\nexports.default = _default;","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _validate = _interopRequireDefault(require(\"./validate.js\"));\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction version(uuid) {\n  if (!(0, _validate.default)(uuid)) {\n    throw TypeError('Invalid UUID');\n  }\n\n  return parseInt(uuid.slice(14, 15), 16);\n}\n\nvar _default = version;\nexports.default = _default;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import \"./styles.css\";\r\nimport \"./components/auth-page/auth.css\"\r\nimport \"./components/main-page/chat-page.css\"\r\nimport { AuthController } from \"./components/auth-page/auth-page-controller\";\r\nimport { ChatController } from \"./components/main-page/chat-page-controller\";\r\nimport { StoreService } from \"./services/session-storage\";\r\nimport { ApplicationEvents } from \"./components/app-server/application-events-server\";\r\nimport { UserListController } from \"./components/users/users-controller\";\r\nimport { LoginService } from \"./services/login-service\";\r\n\r\nlet authController;\r\nlet chatController;\r\nlet userListController;\r\nlet loginService: LoginService\r\n\r\nwindow.onload = () => {\r\n  ApplicationEvents.connect();\r\n\r\n  ApplicationEvents.ws.onopen = () => {\r\n    userListController = new UserListController();\r\n    chatController = new ChatController();\r\n    loginService = new LoginService()\r\n    authController = new AuthController(loginService);\r\n    ApplicationEvents.setAppConrtollers(authController, chatController, userListController)\r\n    const user = StoreService.getUserData();\r\n    StoreService.getUserGender();\r\n  \r\n    if (user) {\r\n      loginService.letUserLogin(user.login, user.password);\r\n    } else {\r\n      authController.drawAuthPage()\r\n    }\r\n  }\r\n  \r\n};"],"names":["ApplicationEvents","connect","ws","WebSocket","this","onmessage","onMessage","setAppConrtollers","authController","chatController","userListController","ev","message","JSON","parse","data","console","log","type","savePas","StoreService","getUserData","userLogin","payload","user","password","setUserData","drawChatPage","setStatus","error","loginError","removeUserData","drawAuthPage","usersActive","users","addUserList","usersInactive","sendMessage","from","ChatControlService","selectedUser","login","to","showMessage","showMessagesHistory","messages","setReadStatus","editMessage","deleteMessage","send","request","id","stringify","constructor","loginService","viewAuth","AuthPageView","document","body","innerHTML","createAuthPage","createAuthForm","inputsValidation","input","errorElement","joinBtn","getElementById","disabled","hasError","validUserCharacters","validPasswordCharacters","test","value","innerText","modalError","createElement","tag","classes","parent","style","display","errorContainer","text","closeBtn","addEventListener","event","key","preventDefault","authMainContainer","signupSection","infoContent","infoButton","seeInfobtn","classList","toggle","contains","setTimeout","attributes","href","signupForm","formList","forEach","placeholder","listItem","for","name","required","errorId","joinBtnListItem","alt","username","letUserLogin","messagesArr","isMyScroll","editedMessage","viewChatPage","ChatPageView","chatControlService","createMainPage","createChatContainer","createChatMenu","createUsersArea","createChatInfo","createChat","getUsersList","setEventListenersToMessage","setEventListenersToSentButton","clearChatWindow","messageInput","dialogContent","querySelector","sendButton","saveButton","messageContent","className","date","Date","datetime","dateTimeString","getMonth","toString","padStart","getDate","getHours","getMinutes","messageHtml","createNewMessage","push","htmlEl","unreadMark","readMark","editdMark","status","isReaded","isEdited","scrollTop","scrollHeight","map","readMessage","find","mes","requestEditMessage","textInput","changeText","edited","findMessage","filter","readMessages","item","requestReadStatus","mesMenu","requestTextEditing","visibility","sendMessageToUser","isEditMode","letUserLogOut","LogOutServis","main","footerInfo","src","chatContainer","chatHeader","usersData","saveUsersLogin","chatWrapper","chatMenu","menuButtons","exitButton","loginedUser","userArea","add","infoMenu","remove","menuUsers","chatContent","chatArea","friendInfo","messageArea","messageDetails","dateTime","messageContainer","messageText","isContextMenuOpen","target","clickedMenu","requestTextDeleting","messageInfo","userList","userListArr","ChatController","drawUserItems","setEventListenertoUser","searchUsers","domUsersList","myLogin","textContent","notme","userItem","classStus","isLogined","externalUser","usersList","textPlace","clickedListItem","openUserhtml","openUserStatus","openUserLogin","finededUser","selectUser","getMessageHistory","searchInput","searchText","toLowerCase","userStatus","userName","includes","messageId","options","element","String","Object","assign","length","appendChild","entries","setAttribute","passwordObj","storedData","sessionStorage","getItem","getUserGender","setUserGender","userGender","setItem","removeItem","defineProperty","exports","enumerable","get","_nil","default","_parse","_stringify","_v","_v2","_v3","_v4","_validate","_version","_interopRequireDefault","obj","__esModule","getOutputLength","inputLength8","safeAdd","x","y","lsw","md5cmn","q","a","b","s","t","num","cnt","md5ff","c","d","md5gg","md5hh","md5ii","_default","bytes","msg","unescape","encodeURIComponent","Uint8Array","i","charCodeAt","output","length32","hexTab","hex","parseInt","charAt","md5ToHexEncodedArray","len","olda","oldb","oldc","oldd","wordsToMd5","length8","Uint32Array","bytesToWords","randomUUID","crypto","bind","uuid","TypeError","v","arr","slice","getRandomValues","Error","rnds8","f","z","ROTL","n","K","H","Array","isArray","prototype","call","l","N","Math","ceil","M","j","pow","floor","W","e","T","unsafeStringify","byteToHex","offset","_rng","_nodeId","_clockseq","_lastMSecs","_lastNSecs","buf","node","clockseq","undefined","seedBytes","random","rng","msecs","now","nsecs","dt","tl","tmh","_md","URL","DNS","version","hashfunc","generateUUID","namespace","_namespace","str","stringToBytes","set","err","_native","rnds","_sha","_regex","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","module","__webpack_modules__","r","Symbol","toStringTag","window","onload","onopen","UserListController","LoginService","AuthController"],"sourceRoot":""}